---
id: new-build-tool
title: Integrating a new build tool
---

Metals currently supports only sbt through the sbt-metals plugins and
`metalsSetup` task. However, metals does not require sbt and can be integrated
with other build tools.

The long-term strategy to integrate metals with build tools is to support some
standard LSP-inspired protocol. An example of how such a protocol might look
like is the draft for a potential
["Build Server Protocol"](https://github.com/scalacenter/bsp/blob/master/docs/bsp.md).
Until such a protocol becomes more standard, metals can import build metadata
through a custom property file format. Property files are generated by the build
tool in the location `<workspace-root>/.metals/buildinfo/**/*.properties`.

Metals expects one property file to correspond to one build
target/module/artifact. For example in sbt, one property file corresponds to one
project+configuration combination. An sbt build with two projects, where one
project has main+test configurations and the other project has
main+test+integration-test configuration, metals expects a total of 5 property
files.

## Build properties

The keys of the build property file format are:

* `sources`: String containing path separated ( `java.io.File.pathSeparator`)
  list of source files for this target.
* `unmanagedSourceDirectories`: String containing path separated list of
  directories where all nested source files belong to this target. Can be empty
  if `sources` is comprehensive, but note that the property file must be
  re-generated whenever a new file is created.
* `managedSourceDirectories`: Same as `unmanagedSourceDirectories`, except for
  automatically generated source files.
* `scalacOptions`: String containing space separated list of compiler options to
  be passed to the Scala presentation compiler. Must not include dependencies.
  It should be valid to pass this value verbatim to the `scalac` command-line
  interface.
* `classDirectory`: String path for a single directory where artifacts for this
  target are output. Compilation artifacts from compiling `sources` should
  appear in `classDirectory`.
* `dependencyClasspath`: String of path separated list of either jar files or
  directories for dependencies of this module.
* `scalaVersion`: String of the Scala compiler version used to compile this
  target. Only 2.12 is supported, consider contributing to
  [#201](https://github.com/scalameta/metals/issues/201) if you would like to
  add 2.11 support.
* `sourceJars`: String of path separated list of jars or directories containing
  `*.scala` and `*.java` source files for the dependencies in
  `libraryDependencies`. Matches the `-source.jar` that are typically published
  to Maven alongside library artifacts. Required to support goto definition in
  the classpath.

Refer to
[MetalsPlugin.scala](https://github.com/scalameta/metals/blob/master/sbt-metals/src/main/scala/scala/meta/sbt/MetalsPlugin.scala)
for an example of how to generate the build properties file format.
